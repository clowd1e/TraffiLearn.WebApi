@model IEnumerable<TopicResponse>

<link rel="stylesheet" href="~/css/AllTopics.css" />

<div id="topics" class="container py-5 d-flex flex-column align-items-center">
    <div class="text-center mb-4 col-12">
        <h1 style="font-weight:700; font-size: 2.5rem; color: #343a40;">Список доступних тем</h1>
        <p style="font-size: 1.2rem; color: #6c757d;">Оберіть тему для початку тестування</p>
    </div>

    @foreach (var topic in Model)
    {
        <div id="topic-@topic.Id" class="topic-item shadow-sm col-10 col-md-8 col-lg-8 mb-3 d-flex align-items-center justify-content-between">
            <a href="~/topic/@topic.Id/questions" class="topic-link btn btn-light text-center flex-grow-1">
                <span style="font-size: 1.2rem;">
                    @topic.Number. @topic.Title
                </span>
            </a>

            <button class="btn delete-btn" style="color: red;" data-id="@topic.Id">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
    }
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var deleteButtons = document.querySelectorAll(".delete-btn");

        deleteButtons.forEach(function (button) {
            button.addEventListener("click", function () {
                var topicId = this.getAttribute("data-id");

                if (confirm("Are you sure you want to delete this topic?")) {
                    fetch(`/topics/${topicId}`, {
                        method: "DELETE"
                    })
                        .then(response => {
                            if (response.ok) {
                                document.getElementById(`topic-${topicId}`).remove();
                            } else {
                                alert("Failed to delete the topic.");
                            }
                        })
                        .catch(error => {
                            console.error("Error:", error);
                            alert("Failed to delete the topic.");
                        });
                }
            });
        });
    });
</script>
